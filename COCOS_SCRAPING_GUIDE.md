# 🎮 Cocos Creator 资源抓取完整指南

## 🎯 功能特点

本工具专门用于抓取 **Cocos Creator** 打包的网页游戏资源，并按照**原始目录结构**保存。

### ✅ 支持的资源类型

#### 1. Cocos Creator 专用资源
- `.plist` - 精灵图集配置
- `.atlas` - 纹理图集
- `.bin` - 二进制资源
- `.proto` - Protobuf 协议
- `.prefab` - 预制体
- `.fire` - 场景文件
- `.scene` - 场景数据
- `.anim` - 动画文件
- `.animclip` - 动画剪辑
- `.effect` - 特效文件
- `.material` - 材质
- `.meta` - 元数据
- `.dbbin` - 数据库二进制
- `.cconb` - Cocos 编译数据

#### 2. Spine 动画资源
- `.skel` - Spine 骨骼数据
- `.atlas` - Spine 纹理图集
- `.json` - Spine JSON 数据

#### 3. 通用游戏资源
- **图片**: `.png`, `.jpg`, `.jpeg`, `.gif`, `.webp`, `.pvr`, `.pkm`, `.astc`, `.ktx`
- **音频**: `.mp3`, `.wav`, `.ogg`, `.m4a`, `.aac`, `.caf`
- **视频**: `.mp4`, `.webm`, `.avi`, `.mov`
- **脚本**: `.js`, `.jsc`, `.ts`, `.json`
- **字体**: `.ttf`, `.otf`, `.woff`, `.woff2`, `.fnt`, `.bmfont`

---

## 🚀 使用步骤

### 步骤 1：启动应用

```bash
npm install
npm run electron:dev
```

### 步骤 2：开始抓取

1. **输入游戏网址**
   - 在顶部输入框输入 Cocos Creator 游戏的完整 URL
   - 例如：`https://example.com/game/index.html`

2. **点击"🚀 开始抓取"**
   - 会打开一个新的浏览器窗口
   - 这个窗口伪装成真实的 Chrome 浏览器

3. **操作游戏**
   - 在抓取窗口中**正常操作游戏**
   - 登录、进入关卡、触发动画等
   - 所有加载的资源都会被自动捕获

4. **资源实时显示**
   - 主窗口的资源列表会**实时更新**
   - 可以看到正在加载的资源

5. **点击"⏸️ 停止抓取"**
   - 完成游戏操作后，点击停止
   - 抓取窗口会关闭

### 步骤 3：筛选资源

1. **按类型筛选**
   - 在左侧筛选面板勾选需要的资源类型
   - 🎮 Cocos - Cocos Creator 专用文件
   - 🦴 Spine - Spine 动画资源
   - 📷 图片 - 游戏贴图
   - 🎵 音频 - 音效和音乐

2. **关键词搜索**
   - 输入 URL 关键词过滤
   - 例如：`assets`、`resources`、`audio`

3. **查看统计**
   - 每个类型后面显示数量
   - 例如：`🎮 Cocos (25)`

### 步骤 4：下载资源

1. **选择资源**
   - 勾选需要下载的资源
   - 或点击"全选"按钮

2. **选择保存目录**
   - 点击"📁 选择目录"按钮
   - 选择保存位置

3. **点击"⬇️ 下载"**
   - 等待下载完成
   - 状态栏显示进度

4. **查看结果**
   - 资源会按照**原始路径结构**保存
   - 例如：
     ```
     保存目录/
     ├── assets/
     │   ├── images/
     │   │   └── bg.png
     │   ├── audio/
     │   │   └── bgm.mp3
     │   └── spine/
     │       ├── hero.skel
     │       ├── hero.atlas
     │       └── hero.png
     └── res/
         └── data.json
     ```

---

## 💡 使用技巧

### 如何抓取所有资源？

1. **完整游戏流程**
   - 登录游戏
   - 浏览所有界面
   - 进入每个关卡
   - 触发所有动画和特效
   - 查看角色和道具

2. **动态资源加载**
   - Cocos Creator 游戏通常**按需加载**资源
   - 只有操作到的地方才会加载对应资源
   - **必须手动触发**才能抓取到

3. **多次抓取**
   - 可以多次抓取不同部分
   - 资源会自动去重（相同 URL）

### 如何识别关键资源？

#### Cocos Creator 项目结构

典型的 Cocos 游戏资源路径：
```
/assets/         - 主要资源目录
/resources/      - 动态加载资源
/res/            - 额外资源
/raw-assets/     - 原始资源
/src/            - 源代码（通常已编译）
```

#### 重要文件类型

| 文件类型 | 作用 | 重要性 |
|---------|------|--------|
| `.plist` | 精灵图集配置 | ⭐⭐⭐ |
| `.atlas` | 纹理图集描述 | ⭐⭐⭐ |
| `.prefab` | 预制体（UI、角色） | ⭐⭐⭐ |
| `.fire` | 场景文件 | ⭐⭐⭐ |
| `.skel` | Spine 骨骼动画 | ⭐⭐⭐ |
| `.png/.jpg` | 游戏贴图 | ⭐⭐⭐ |
| `.mp3/.wav` | 音频 | ⭐⭐ |
| `.json` | 配置数据 | ⭐⭐ |

### 如何处理加密资源？

某些 Cocos 游戏会加密资源：

1. **XOR 加密**
   - 常见的简单加密
   - 需要找到密钥解密

2. **自定义加密**
   - 需要逆向分析 `game.js`
   - 找到解密函数

3. **建议**
   - 先抓取所有资源
   - 尝试直接使用（有些资源未加密）
   - 如需解密，需要额外的工具

---

## 🔍 常见问题

### Q1: 为什么有些资源没有抓到？

**A**: 可能的原因：

1. **资源还没加载**
   - 解决：在游戏中操作到该资源所在的位置
   - 例如：查看某个角色，才会加载该角色的资源

2. **资源使用 Base64 内嵌**
   - 某些小图标可能内嵌在代码中
   - 无法通过网络请求抓取

3. **资源来自其他域名**
   - 检查是否使用了 CDN
   - 确认 URL 是否正确

### Q2: 下载失败怎么办？

**A**: 检查：

1. **网络连接**
   - 确保可以访问资源 URL
   - 尝试在浏览器中直接打开 URL

2. **防火墙/代理**
   - 某些资源服务器可能有访问限制
   - 尝试关闭代理或 VPN

3. **文件路径过长**
   - Windows 路径有长度限制
   - 选择较短的保存路径

4. **权限问题**
   - 确保有写入权限
   - 尝试选择其他目录

### Q3: 如何查看下载的文件？

**A**: 直接打开保存目录：

```
Windows: 资源管理器中打开选择的目录
文件结构：按照原始 URL 路径保存
```

例如，URL 为 `https://example.com/assets/images/bg.png`
保存为：`你的目录/assets/images/bg.png`

### Q4: 可以抓取非 Cocos 游戏吗？

**A**: 可以！

虽然工具针对 Cocos Creator 优化，但也支持：
- Unity WebGL 游戏
- Phaser 游戏
- PixiJS 游戏
- 任何 HTML5 游戏

只要资源是通过 HTTP/HTTPS 加载的，都能抓取。

### Q5: 抓取是否合法？

**A**: 注意事项：

- ⚠️ 本工具**仅用于学习和研究**
- ⚠️ 不要用于商业用途
- ⚠️ 尊重游戏版权
- ⚠️ 不要分发抓取的资源
- ⚠️ 研究完成后建议删除

---

## 🛠️ 高级功能

### 并发下载控制

默认同时下载 **5 个文件**，可在 `electron/main.cjs` 中修改：

```javascript
const concurrency = 5 // 修改这个数字
```

- 增大：下载更快，但可能被服务器限制
- 减小：更稳定，但速度慢

### 超时设置

默认请求超时 **30 秒**，可修改：

```javascript
request.setTimeout(30000, () => {  // 毫秒
```

### 自定义过滤规则

在 `shouldCollectResource` 函数中添加：

```javascript
// 只抓取特定路径的资源
if (!url.includes('/assets/')) return false

// 排除特定文件
if (url.endsWith('.html')) return false
```

---

## 📊 性能优化

### 大型游戏优化

如果游戏资源很多（1000+ 个）：

1. **分批抓取**
   - 第一次：抓取 UI 资源
   - 第二次：抓取关卡资源
   - 第三次：抓取音频资源

2. **筛选后下载**
   - 使用类型筛选，只下载需要的
   - 使用关键词搜索，精确定位

3. **检查磁盘空间**
   - 游戏资源可能很大（几 GB）
   - 确保有足够空间

---

## 🎓 学习建议

### 使用抓取的资源学习

1. **分析项目结构**
   - 研究 Cocos 的资源组织方式
   - 学习命名规范

2. **研究图集优化**
   - 查看 `.plist` 文件
   - 了解精灵图集的打包方式

3. **学习动画制作**
   - 分析 Spine 动画文件
   - 研究骨骼动画原理

4. **代码学习**
   - 阅读 `.js` 脚本（如果未压缩）
   - 学习游戏逻辑实现

### 工具推荐

配合其他工具使用：

- **TexturePacker** - 查看和编辑图集
- **Spine** - 查看骨骼动画
- **VS Code** - 查看 JSON 和脚本
- **Cocos Creator** - 导入和研究资源

---

## 📝 快速参考

### 快捷操作

| 操作 | 快捷方式 |
|------|---------|
| 全选资源 | 点击"全选"按钮 |
| 清空筛选 | 点击"清空"按钮 |
| 复制链接 | 点击资源后的📋按钮 |
| 开始/停止 | 输入框右侧按钮 |

### 状态提示

| 图标 | 含义 |
|------|------|
| 🚀 | 开始抓取 |
| ⏸️ | 停止抓取 |
| ⬇️ | 开始下载 |
| 📁 | 选择目录 |
| ✅ | 操作成功 |
| ❌ | 操作失败 |

---

## 🆘 获取帮助

### 查看文档

- `README.md` - 项目简介
- `WEBGL_DEEP_FIX.md` - WebGL 问题修复
- `FIX_CLONE_ERROR.md` - 下载错误修复
- `CHANGELOG.md` - 更新日志

### 常见错误

1. **"不支持 WebGL"** → 查看 `WEBGL_DEEP_FIX.md`
2. **"An object could not be cloned"** → 查看 `FIX_CLONE_ERROR.md`
3. **窗口不显示** → 完全重启应用
4. **下载失败** → 检查网络和权限

---

## ✨ 最佳实践总结

1. **完整操作游戏**
   - 浏览所有界面和关卡
   - 触发所有动画和特效

2. **合理筛选资源**
   - 只下载需要的资源类型
   - 使用关键词精确定位

3. **按原始结构保存**
   - 工具会自动保留目录结构
   - 便于理解项目组织

4. **学习后删除**
   - 研究完成后删除资源
   - 尊重原作者版权

---

**祝你学习愉快！** 🎉

如有问题，欢迎查看其他文档或提Issue。
